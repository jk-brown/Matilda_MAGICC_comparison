---
title: "04_plotting results"
author: "Joe Brown"
date: "2024-11-13"
output: html_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

### weighted wamring

```{r}
gmst_ensemble <- do.call(rbind, gmst_data)
row.names(gmst_ensemble) <-  NULL

# median (CI) warming calculation
gmst_projection <- gmst_ensemble %>% 
  group_by(year, scenario) %>% 
  summarize(
    median = weighted.quantile(x = value, w = mc_weight, probs = 0.5), 
    ci_5 = weighted.quantile(x = value, w = mc_weight, probs = 0.05),
    ci_10 = weighted.quantile(x = value, w = mc_weight, probs = 0.10), 
    ci_90 = weighted.quantile(x = value, w = mc_weight, probs = 0.90), 
    ci_95 = weighted.quantile(x = value, w = mc_weight, probs = 0.95),
    ci_66 = weighted.quantile(x = value, w = mc_weight, probs = 0.66), 
    ci_33 = weighted.quantile(x = value, w = mc_weight, probs = 0.33),
    .groups = "drop")
```

```{r}
temp_projection_plot <- 
  ggplot(data = subset(gmst_projection, 
                       year > 2005)) +
  geom_line(aes(x = year, 
                y = median, 
                color = scenario), 
            linewidth = 0.75) +
  geom_ribbon(aes(x = year, 
                  ymin = ci_10, 
                  ymax = ci_90, 
                  fill = scenario, 
                  color = scenario), 
              alpha = 0.3, 
              linetype = "blank") +
  labs(x = "Year", 
       y = expression(paste("Future Warming (GSAT) relative to 1995-2014 (", degree, "C)"))) +
    facet_wrap(~scenario) +
  theme_light()

temp_projection_plot
```

